using Base.MathConstants

@testset "exponential integral" begin
    @testset "E₁" begin
        @test E₁(0) == Inf
        @test E₁(1) ≅ 0.219383934395520273677163775460121649031047293406908207577
        @test E₁(2) ≅ 0.048900510708061119567239835228049522314492184963023116327
        @test E₁(10) ≅ 4.1569689296853242774028598102781803843462900824195331e-6
        @test E₁(100) ≅ 3.6835977616820321802351926205081189876552201369095676e-46
        @test E₁(500) ≅ 1.422076782253638422098193936057278281607864840846107e-220
        @test E₁(800) ≅ 0.0
    end

    @testset "En" begin
        @test En(0, 1) ≅ 1/e
        @test En(0, 2) ≅ 1/(2e^2)
        @test En(2, 0) == 1.0
        @test En(3, 0) == 0.5
        @test En(1, -5) ≅ -40.185275355803177455091421793795867095419087399195930434 - 3.1415926535897932384626433832795028841971693993751058209im
        @test En(1, -5+0.01im) ≅ -40.184088057852053166778027787056086608566881324182021075 - 2.8447696994032256009548700952561340708768881138416215357im
        @test En(1, -5+1im) ≅ -29.025158144992710296353782915633718625839577127679530594 + 23.304702810489904370776539518061890789478578493028994502im
        @test En(10im, -10+10im) ≅ 842.196601731195121156507301117535342516890218271788126699 + 481.296521260231635469781278283025739948078026046933687102im
    end
end
